{"ast":null,"code":"var WebSocket = WebSocket || require('ws');\n\nmodule.exports = function (self) {\n  var socket = null;\n\n  function handleSocketMessage(ev) {\n    var data = ev.data;\n\n    if (data instanceof ArrayBuffer) {\n      // binary message, transfer for speed\n      self.postMessage(data, [data]);\n    } else {\n      // JSON message, copy string\n      self.postMessage(data);\n    }\n  }\n\n  function handleSocketControl(ev) {\n    self.postMessage({\n      type: ev.type\n    });\n  }\n\n  self.addEventListener('message', function (ev) {\n    var data = ev.data;\n\n    if (typeof data === 'string') {\n      // JSON message from ROSLIB\n      socket.send(data);\n    } else {\n      // control message\n      if (data.hasOwnProperty('close')) {\n        socket.close();\n        socket = null;\n      } else if (data.hasOwnProperty('uri')) {\n        var uri = data.uri;\n        socket = new WebSocket(uri);\n        socket.binaryType = 'arraybuffer';\n        socket.onmessage = handleSocketMessage;\n        socket.onclose = handleSocketControl;\n        socket.onopen = handleSocketControl;\n        socket.onerror = handleSocketControl;\n      } else {\n        throw 'Unknown message to WorkerSocket';\n      }\n    }\n  });\n};","map":{"version":3,"names":["WebSocket","require","module","exports","self","socket","handleSocketMessage","ev","data","ArrayBuffer","postMessage","handleSocketControl","type","addEventListener","send","hasOwnProperty","close","uri","binaryType","onmessage","onclose","onopen","onerror"],"sources":["/home/daeho/Documents/react/study/node_modules/roslib/src/util/workerSocketImpl.js"],"sourcesContent":["var WebSocket = WebSocket || require('ws');\n\nmodule.exports = function(self) {\n  var socket = null;\n\n  function handleSocketMessage(ev) {\n    var data = ev.data;\n\n    if (data instanceof ArrayBuffer) {\n      // binary message, transfer for speed\n      self.postMessage(data, [data]);\n    } else {\n      // JSON message, copy string\n      self.postMessage(data);\n    }\n  }\n\n  function handleSocketControl(ev) {\n    self.postMessage({type: ev.type});\n  }\n\n  self.addEventListener('message', function(ev) {\n    var data = ev.data;\n\n    if (typeof data === 'string') {\n      // JSON message from ROSLIB\n      socket.send(data);\n    } else {\n      // control message\n      if (data.hasOwnProperty('close')) {\n        socket.close();\n        socket = null;\n      } else if (data.hasOwnProperty('uri')) {\n        var uri = data.uri;\n\n        socket = new WebSocket(uri);\n        socket.binaryType = 'arraybuffer';\n\n        socket.onmessage = handleSocketMessage;\n        socket.onclose = handleSocketControl;\n        socket.onopen = handleSocketControl;\n        socket.onerror = handleSocketControl;\n      } else {\n        throw 'Unknown message to WorkerSocket';\n      }\n    }\n  });\n};\n"],"mappings":"AAAA,IAAIA,SAAS,GAAGA,SAAS,IAAIC,OAAO,CAAC,IAAD,CAApC;;AAEAC,MAAM,CAACC,OAAP,GAAiB,UAASC,IAAT,EAAe;EAC9B,IAAIC,MAAM,GAAG,IAAb;;EAEA,SAASC,mBAAT,CAA6BC,EAA7B,EAAiC;IAC/B,IAAIC,IAAI,GAAGD,EAAE,CAACC,IAAd;;IAEA,IAAIA,IAAI,YAAYC,WAApB,EAAiC;MAC/B;MACAL,IAAI,CAACM,WAAL,CAAiBF,IAAjB,EAAuB,CAACA,IAAD,CAAvB;IACD,CAHD,MAGO;MACL;MACAJ,IAAI,CAACM,WAAL,CAAiBF,IAAjB;IACD;EACF;;EAED,SAASG,mBAAT,CAA6BJ,EAA7B,EAAiC;IAC/BH,IAAI,CAACM,WAAL,CAAiB;MAACE,IAAI,EAAEL,EAAE,CAACK;IAAV,CAAjB;EACD;;EAEDR,IAAI,CAACS,gBAAL,CAAsB,SAAtB,EAAiC,UAASN,EAAT,EAAa;IAC5C,IAAIC,IAAI,GAAGD,EAAE,CAACC,IAAd;;IAEA,IAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;MAC5B;MACAH,MAAM,CAACS,IAAP,CAAYN,IAAZ;IACD,CAHD,MAGO;MACL;MACA,IAAIA,IAAI,CAACO,cAAL,CAAoB,OAApB,CAAJ,EAAkC;QAChCV,MAAM,CAACW,KAAP;QACAX,MAAM,GAAG,IAAT;MACD,CAHD,MAGO,IAAIG,IAAI,CAACO,cAAL,CAAoB,KAApB,CAAJ,EAAgC;QACrC,IAAIE,GAAG,GAAGT,IAAI,CAACS,GAAf;QAEAZ,MAAM,GAAG,IAAIL,SAAJ,CAAciB,GAAd,CAAT;QACAZ,MAAM,CAACa,UAAP,GAAoB,aAApB;QAEAb,MAAM,CAACc,SAAP,GAAmBb,mBAAnB;QACAD,MAAM,CAACe,OAAP,GAAiBT,mBAAjB;QACAN,MAAM,CAACgB,MAAP,GAAgBV,mBAAhB;QACAN,MAAM,CAACiB,OAAP,GAAiBX,mBAAjB;MACD,CAVM,MAUA;QACL,MAAM,iCAAN;MACD;IACF;EACF,CAzBD;AA0BD,CA7CD"},"metadata":{},"sourceType":"script"}