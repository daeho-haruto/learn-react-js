{"ast":null,"code":"/**\n * @fileoverview\n * @author David Gossow - dgossow@willowgarage.com\n */\nvar ActionClient = require('../actionlib/ActionClient');\n\nvar Goal = require('../actionlib/Goal');\n\nvar Service = require('../core/Service.js');\n\nvar ServiceRequest = require('../core/ServiceRequest.js');\n\nvar Topic = require('../core/Topic.js');\n\nvar Transform = require('../math/Transform');\n/**\n * A TF Client that listens to TFs from tf2_web_republisher.\n *\n *  @constructor\n *  @param options - object with following keys:\n *   * ros - the ROSLIB.Ros connection handle\n *   * fixedFrame - the fixed frame, like /base_link\n *   * angularThres - the angular threshold for the TF republisher\n *   * transThres - the translation threshold for the TF republisher\n *   * rate - the rate for the TF republisher\n *   * updateDelay - the time (in ms) to wait after a new subscription\n *                   to update the TF republisher's list of TFs\n *   * topicTimeout - the timeout parameter for the TF republisher\n *   * serverName (optional) - the name of the tf2_web_republisher server\n *   * repubServiceName (optional) - the name of the republish_tfs service (non groovy compatibility mode only)\n *   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t default: '/republish_tfs'\n */\n\n\nfunction TFClient(options) {\n  options = options || {};\n  this.ros = options.ros;\n  this.fixedFrame = options.fixedFrame || '/base_link';\n  this.angularThres = options.angularThres || 2.0;\n  this.transThres = options.transThres || 0.01;\n  this.rate = options.rate || 10.0;\n  this.updateDelay = options.updateDelay || 50;\n  var seconds = options.topicTimeout || 2.0;\n  var secs = Math.floor(seconds);\n  var nsecs = Math.floor((seconds - secs) * 1000000000);\n  this.topicTimeout = {\n    secs: secs,\n    nsecs: nsecs\n  };\n  this.serverName = options.serverName || '/tf2_web_republisher';\n  this.repubServiceName = options.repubServiceName || '/republish_tfs';\n  this.currentGoal = false;\n  this.currentTopic = false;\n  this.frameInfos = {};\n  this.republisherUpdateRequested = false;\n  this._subscribeCB = null;\n  this._isDisposed = false; // Create an Action client\n\n  this.actionClient = new ActionClient({\n    ros: options.ros,\n    serverName: this.serverName,\n    actionName: 'tf2_web_republisher/TFSubscriptionAction',\n    omitStatus: true,\n    omitResult: true\n  }); // Create a Service client\n\n  this.serviceClient = new Service({\n    ros: options.ros,\n    name: this.repubServiceName,\n    serviceType: 'tf2_web_republisher/RepublishTFs'\n  });\n}\n/**\n * Process the incoming TF message and send them out using the callback\n * functions.\n *\n * @param tf - the TF message from the server\n */\n\n\nTFClient.prototype.processTFArray = function (tf) {\n  var that = this;\n  tf.transforms.forEach(function (transform) {\n    var frameID = transform.child_frame_id;\n\n    if (frameID[0] === '/') {\n      frameID = frameID.substring(1);\n    }\n\n    var info = this.frameInfos[frameID];\n\n    if (info) {\n      info.transform = new Transform({\n        translation: transform.transform.translation,\n        rotation: transform.transform.rotation\n      });\n      info.cbs.forEach(function (cb) {\n        cb(info.transform);\n      });\n    }\n  }, this);\n};\n/**\n * Create and send a new goal (or service request) to the tf2_web_republisher\n * based on the current list of TFs.\n */\n\n\nTFClient.prototype.updateGoal = function () {\n  var goalMessage = {\n    source_frames: Object.keys(this.frameInfos),\n    target_frame: this.fixedFrame,\n    angular_thres: this.angularThres,\n    trans_thres: this.transThres,\n    rate: this.rate\n  }; // if we're running in groovy compatibility mode (the default)\n  // then use the action interface to tf2_web_republisher\n\n  if (this.ros.groovyCompatibility) {\n    if (this.currentGoal) {\n      this.currentGoal.cancel();\n    }\n\n    this.currentGoal = new Goal({\n      actionClient: this.actionClient,\n      goalMessage: goalMessage\n    });\n    this.currentGoal.on('feedback', this.processTFArray.bind(this));\n    this.currentGoal.send();\n  } else {\n    // otherwise, use the service interface\n    // The service interface has the same parameters as the action,\n    // plus the timeout\n    goalMessage.timeout = this.topicTimeout;\n    var request = new ServiceRequest(goalMessage);\n    this.serviceClient.callService(request, this.processResponse.bind(this));\n  }\n\n  this.republisherUpdateRequested = false;\n};\n/**\n * Process the service response and subscribe to the tf republisher\n * topic\n *\n * @param response the service response containing the topic name\n */\n\n\nTFClient.prototype.processResponse = function (response) {\n  // Do not setup a topic subscription if already disposed. Prevents a race condition where\n  // The dispose() function is called before the service call receives a response.\n  if (this._isDisposed) {\n    return;\n  } // if we subscribed to a topic before, unsubscribe so\n  // the republisher stops publishing it\n\n\n  if (this.currentTopic) {\n    this.currentTopic.unsubscribe(this._subscribeCB);\n  }\n\n  this.currentTopic = new Topic({\n    ros: this.ros,\n    name: response.topic_name,\n    messageType: 'tf2_web_republisher/TFArray'\n  });\n  this._subscribeCB = this.processTFArray.bind(this);\n  this.currentTopic.subscribe(this._subscribeCB);\n};\n/**\n * Subscribe to the given TF frame.\n *\n * @param frameID - the TF frame to subscribe to\n * @param callback - function with params:\n *   * transform - the transform data\n */\n\n\nTFClient.prototype.subscribe = function (frameID, callback) {\n  // remove leading slash, if it's there\n  if (frameID[0] === '/') {\n    frameID = frameID.substring(1);\n  } // if there is no callback registered for the given frame, create emtpy callback list\n\n\n  if (!this.frameInfos[frameID]) {\n    this.frameInfos[frameID] = {\n      cbs: []\n    };\n\n    if (!this.republisherUpdateRequested) {\n      setTimeout(this.updateGoal.bind(this), this.updateDelay);\n      this.republisherUpdateRequested = true;\n    }\n  } // if we already have a transform, call back immediately\n  else if (this.frameInfos[frameID].transform) {\n    callback(this.frameInfos[frameID].transform);\n  }\n\n  this.frameInfos[frameID].cbs.push(callback);\n};\n/**\n * Unsubscribe from the given TF frame.\n *\n * @param frameID - the TF frame to unsubscribe from\n * @param callback - the callback function to remove\n */\n\n\nTFClient.prototype.unsubscribe = function (frameID, callback) {\n  // remove leading slash, if it's there\n  if (frameID[0] === '/') {\n    frameID = frameID.substring(1);\n  }\n\n  var info = this.frameInfos[frameID];\n\n  for (var cbs = info && info.cbs || [], idx = cbs.length; idx--;) {\n    if (cbs[idx] === callback) {\n      cbs.splice(idx, 1);\n    }\n  }\n\n  if (!callback || cbs.length === 0) {\n    delete this.frameInfos[frameID];\n  }\n};\n/**\n * Unsubscribe and unadvertise all topics associated with this TFClient.\n */\n\n\nTFClient.prototype.dispose = function () {\n  this._isDisposed = true;\n  this.actionClient.dispose();\n\n  if (this.currentTopic) {\n    this.currentTopic.unsubscribe(this._subscribeCB);\n  }\n};\n\nmodule.exports = TFClient;","map":{"version":3,"names":["ActionClient","require","Goal","Service","ServiceRequest","Topic","Transform","TFClient","options","ros","fixedFrame","angularThres","transThres","rate","updateDelay","seconds","topicTimeout","secs","Math","floor","nsecs","serverName","repubServiceName","currentGoal","currentTopic","frameInfos","republisherUpdateRequested","_subscribeCB","_isDisposed","actionClient","actionName","omitStatus","omitResult","serviceClient","name","serviceType","prototype","processTFArray","tf","that","transforms","forEach","transform","frameID","child_frame_id","substring","info","translation","rotation","cbs","cb","updateGoal","goalMessage","source_frames","Object","keys","target_frame","angular_thres","trans_thres","groovyCompatibility","cancel","on","bind","send","timeout","request","callService","processResponse","response","unsubscribe","topic_name","messageType","subscribe","callback","setTimeout","push","idx","length","splice","dispose","module","exports"],"sources":["/home/daeho/Documents/react/study/node_modules/roslib/src/tf/TFClient.js"],"sourcesContent":["/**\n * @fileoverview\n * @author David Gossow - dgossow@willowgarage.com\n */\n\nvar ActionClient = require('../actionlib/ActionClient');\nvar Goal = require('../actionlib/Goal');\n\nvar Service = require('../core/Service.js');\nvar ServiceRequest = require('../core/ServiceRequest.js');\nvar Topic = require('../core/Topic.js');\n\nvar Transform = require('../math/Transform');\n\n/**\n * A TF Client that listens to TFs from tf2_web_republisher.\n *\n *  @constructor\n *  @param options - object with following keys:\n *   * ros - the ROSLIB.Ros connection handle\n *   * fixedFrame - the fixed frame, like /base_link\n *   * angularThres - the angular threshold for the TF republisher\n *   * transThres - the translation threshold for the TF republisher\n *   * rate - the rate for the TF republisher\n *   * updateDelay - the time (in ms) to wait after a new subscription\n *                   to update the TF republisher's list of TFs\n *   * topicTimeout - the timeout parameter for the TF republisher\n *   * serverName (optional) - the name of the tf2_web_republisher server\n *   * repubServiceName (optional) - the name of the republish_tfs service (non groovy compatibility mode only)\n *   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t default: '/republish_tfs'\n */\nfunction TFClient(options) {\n  options = options || {};\n  this.ros = options.ros;\n  this.fixedFrame = options.fixedFrame || '/base_link';\n  this.angularThres = options.angularThres || 2.0;\n  this.transThres = options.transThres || 0.01;\n  this.rate = options.rate || 10.0;\n  this.updateDelay = options.updateDelay || 50;\n  var seconds = options.topicTimeout || 2.0;\n  var secs = Math.floor(seconds);\n  var nsecs = Math.floor((seconds - secs) * 1000000000);\n  this.topicTimeout = {\n    secs: secs,\n    nsecs: nsecs\n  };\n  this.serverName = options.serverName || '/tf2_web_republisher';\n  this.repubServiceName = options.repubServiceName || '/republish_tfs';\n\n  this.currentGoal = false;\n  this.currentTopic = false;\n  this.frameInfos = {};\n  this.republisherUpdateRequested = false;\n  this._subscribeCB = null;\n  this._isDisposed = false;\n\n  // Create an Action client\n  this.actionClient = new ActionClient({\n    ros : options.ros,\n    serverName : this.serverName,\n    actionName : 'tf2_web_republisher/TFSubscriptionAction',\n    omitStatus : true,\n    omitResult : true\n  });\n\n  // Create a Service client\n  this.serviceClient = new Service({\n    ros: options.ros,\n    name: this.repubServiceName,\n    serviceType: 'tf2_web_republisher/RepublishTFs'\n  });\n}\n\n/**\n * Process the incoming TF message and send them out using the callback\n * functions.\n *\n * @param tf - the TF message from the server\n */\nTFClient.prototype.processTFArray = function(tf) {\n  var that = this;\n  tf.transforms.forEach(function(transform) {\n    var frameID = transform.child_frame_id;\n    if (frameID[0] === '/')\n    {\n      frameID = frameID.substring(1);\n    }\n    var info = this.frameInfos[frameID];\n    if (info) {\n      info.transform = new Transform({\n        translation : transform.transform.translation,\n        rotation : transform.transform.rotation\n      });\n      info.cbs.forEach(function(cb) {\n        cb(info.transform);\n      });\n    }\n  }, this);\n};\n\n/**\n * Create and send a new goal (or service request) to the tf2_web_republisher\n * based on the current list of TFs.\n */\nTFClient.prototype.updateGoal = function() {\n  var goalMessage = {\n    source_frames : Object.keys(this.frameInfos),\n    target_frame : this.fixedFrame,\n    angular_thres : this.angularThres,\n    trans_thres : this.transThres,\n    rate : this.rate\n  };\n\n  // if we're running in groovy compatibility mode (the default)\n  // then use the action interface to tf2_web_republisher\n  if(this.ros.groovyCompatibility) {\n    if (this.currentGoal) {\n      this.currentGoal.cancel();\n    }\n    this.currentGoal = new Goal({\n      actionClient : this.actionClient,\n      goalMessage : goalMessage\n    });\n\n    this.currentGoal.on('feedback', this.processTFArray.bind(this));\n    this.currentGoal.send();\n  }\n  else {\n    // otherwise, use the service interface\n    // The service interface has the same parameters as the action,\n    // plus the timeout\n    goalMessage.timeout = this.topicTimeout;\n    var request = new ServiceRequest(goalMessage);\n\n    this.serviceClient.callService(request, this.processResponse.bind(this));\n  }\n\n  this.republisherUpdateRequested = false;\n};\n\n/**\n * Process the service response and subscribe to the tf republisher\n * topic\n *\n * @param response the service response containing the topic name\n */\nTFClient.prototype.processResponse = function(response) {\n  // Do not setup a topic subscription if already disposed. Prevents a race condition where\n  // The dispose() function is called before the service call receives a response.\n  if (this._isDisposed) {\n    return;\n  }\n\n  // if we subscribed to a topic before, unsubscribe so\n  // the republisher stops publishing it\n  if (this.currentTopic) {\n    this.currentTopic.unsubscribe(this._subscribeCB);\n  }\n\n  this.currentTopic = new Topic({\n    ros: this.ros,\n    name: response.topic_name,\n    messageType: 'tf2_web_republisher/TFArray'\n  });\n  this._subscribeCB = this.processTFArray.bind(this);\n  this.currentTopic.subscribe(this._subscribeCB);\n};\n\n/**\n * Subscribe to the given TF frame.\n *\n * @param frameID - the TF frame to subscribe to\n * @param callback - function with params:\n *   * transform - the transform data\n */\nTFClient.prototype.subscribe = function(frameID, callback) {\n  // remove leading slash, if it's there\n  if (frameID[0] === '/')\n  {\n    frameID = frameID.substring(1);\n  }\n  // if there is no callback registered for the given frame, create emtpy callback list\n  if (!this.frameInfos[frameID]) {\n    this.frameInfos[frameID] = {\n      cbs: []\n    };\n    if (!this.republisherUpdateRequested) {\n      setTimeout(this.updateGoal.bind(this), this.updateDelay);\n      this.republisherUpdateRequested = true;\n    }\n  }\n  // if we already have a transform, call back immediately\n  else if (this.frameInfos[frameID].transform) {\n    callback(this.frameInfos[frameID].transform);\n  }\n  this.frameInfos[frameID].cbs.push(callback);\n};\n\n/**\n * Unsubscribe from the given TF frame.\n *\n * @param frameID - the TF frame to unsubscribe from\n * @param callback - the callback function to remove\n */\nTFClient.prototype.unsubscribe = function(frameID, callback) {\n  // remove leading slash, if it's there\n  if (frameID[0] === '/')\n  {\n    frameID = frameID.substring(1);\n  }\n  var info = this.frameInfos[frameID];\n  for (var cbs = info && info.cbs || [], idx = cbs.length; idx--;) {\n    if (cbs[idx] === callback) {\n      cbs.splice(idx, 1);\n    }\n  }\n  if (!callback || cbs.length === 0) {\n    delete this.frameInfos[frameID];\n  }\n};\n\n/**\n * Unsubscribe and unadvertise all topics associated with this TFClient.\n */\nTFClient.prototype.dispose = function() {\n  this._isDisposed = true;\n  this.actionClient.dispose();\n  if (this.currentTopic) {\n    this.currentTopic.unsubscribe(this._subscribeCB);\n  }\n};\n\nmodule.exports = TFClient;\n"],"mappings":"AAAA;AACA;AACA;AACA;AAEA,IAAIA,YAAY,GAAGC,OAAO,CAAC,2BAAD,CAA1B;;AACA,IAAIC,IAAI,GAAGD,OAAO,CAAC,mBAAD,CAAlB;;AAEA,IAAIE,OAAO,GAAGF,OAAO,CAAC,oBAAD,CAArB;;AACA,IAAIG,cAAc,GAAGH,OAAO,CAAC,2BAAD,CAA5B;;AACA,IAAII,KAAK,GAAGJ,OAAO,CAAC,kBAAD,CAAnB;;AAEA,IAAIK,SAAS,GAAGL,OAAO,CAAC,mBAAD,CAAvB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASM,QAAT,CAAkBC,OAAlB,EAA2B;EACzBA,OAAO,GAAGA,OAAO,IAAI,EAArB;EACA,KAAKC,GAAL,GAAWD,OAAO,CAACC,GAAnB;EACA,KAAKC,UAAL,GAAkBF,OAAO,CAACE,UAAR,IAAsB,YAAxC;EACA,KAAKC,YAAL,GAAoBH,OAAO,CAACG,YAAR,IAAwB,GAA5C;EACA,KAAKC,UAAL,GAAkBJ,OAAO,CAACI,UAAR,IAAsB,IAAxC;EACA,KAAKC,IAAL,GAAYL,OAAO,CAACK,IAAR,IAAgB,IAA5B;EACA,KAAKC,WAAL,GAAmBN,OAAO,CAACM,WAAR,IAAuB,EAA1C;EACA,IAAIC,OAAO,GAAGP,OAAO,CAACQ,YAAR,IAAwB,GAAtC;EACA,IAAIC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWJ,OAAX,CAAX;EACA,IAAIK,KAAK,GAAGF,IAAI,CAACC,KAAL,CAAW,CAACJ,OAAO,GAAGE,IAAX,IAAmB,UAA9B,CAAZ;EACA,KAAKD,YAAL,GAAoB;IAClBC,IAAI,EAAEA,IADY;IAElBG,KAAK,EAAEA;EAFW,CAApB;EAIA,KAAKC,UAAL,GAAkBb,OAAO,CAACa,UAAR,IAAsB,sBAAxC;EACA,KAAKC,gBAAL,GAAwBd,OAAO,CAACc,gBAAR,IAA4B,gBAApD;EAEA,KAAKC,WAAL,GAAmB,KAAnB;EACA,KAAKC,YAAL,GAAoB,KAApB;EACA,KAAKC,UAAL,GAAkB,EAAlB;EACA,KAAKC,0BAAL,GAAkC,KAAlC;EACA,KAAKC,YAAL,GAAoB,IAApB;EACA,KAAKC,WAAL,GAAmB,KAAnB,CAvByB,CAyBzB;;EACA,KAAKC,YAAL,GAAoB,IAAI7B,YAAJ,CAAiB;IACnCS,GAAG,EAAGD,OAAO,CAACC,GADqB;IAEnCY,UAAU,EAAG,KAAKA,UAFiB;IAGnCS,UAAU,EAAG,0CAHsB;IAInCC,UAAU,EAAG,IAJsB;IAKnCC,UAAU,EAAG;EALsB,CAAjB,CAApB,CA1ByB,CAkCzB;;EACA,KAAKC,aAAL,GAAqB,IAAI9B,OAAJ,CAAY;IAC/BM,GAAG,EAAED,OAAO,CAACC,GADkB;IAE/ByB,IAAI,EAAE,KAAKZ,gBAFoB;IAG/Ba,WAAW,EAAE;EAHkB,CAAZ,CAArB;AAKD;AAED;AACA;AACA;AACA;AACA;AACA;;;AACA5B,QAAQ,CAAC6B,SAAT,CAAmBC,cAAnB,GAAoC,UAASC,EAAT,EAAa;EAC/C,IAAIC,IAAI,GAAG,IAAX;EACAD,EAAE,CAACE,UAAH,CAAcC,OAAd,CAAsB,UAASC,SAAT,EAAoB;IACxC,IAAIC,OAAO,GAAGD,SAAS,CAACE,cAAxB;;IACA,IAAID,OAAO,CAAC,CAAD,CAAP,KAAe,GAAnB,EACA;MACEA,OAAO,GAAGA,OAAO,CAACE,SAAR,CAAkB,CAAlB,CAAV;IACD;;IACD,IAAIC,IAAI,GAAG,KAAKrB,UAAL,CAAgBkB,OAAhB,CAAX;;IACA,IAAIG,IAAJ,EAAU;MACRA,IAAI,CAACJ,SAAL,GAAiB,IAAIpC,SAAJ,CAAc;QAC7ByC,WAAW,EAAGL,SAAS,CAACA,SAAV,CAAoBK,WADL;QAE7BC,QAAQ,EAAGN,SAAS,CAACA,SAAV,CAAoBM;MAFF,CAAd,CAAjB;MAIAF,IAAI,CAACG,GAAL,CAASR,OAAT,CAAiB,UAASS,EAAT,EAAa;QAC5BA,EAAE,CAACJ,IAAI,CAACJ,SAAN,CAAF;MACD,CAFD;IAGD;EACF,CAhBD,EAgBG,IAhBH;AAiBD,CAnBD;AAqBA;AACA;AACA;AACA;;;AACAnC,QAAQ,CAAC6B,SAAT,CAAmBe,UAAnB,GAAgC,YAAW;EACzC,IAAIC,WAAW,GAAG;IAChBC,aAAa,EAAGC,MAAM,CAACC,IAAP,CAAY,KAAK9B,UAAjB,CADA;IAEhB+B,YAAY,EAAG,KAAK9C,UAFJ;IAGhB+C,aAAa,EAAG,KAAK9C,YAHL;IAIhB+C,WAAW,EAAG,KAAK9C,UAJH;IAKhBC,IAAI,EAAG,KAAKA;EALI,CAAlB,CADyC,CASzC;EACA;;EACA,IAAG,KAAKJ,GAAL,CAASkD,mBAAZ,EAAiC;IAC/B,IAAI,KAAKpC,WAAT,EAAsB;MACpB,KAAKA,WAAL,CAAiBqC,MAAjB;IACD;;IACD,KAAKrC,WAAL,GAAmB,IAAIrB,IAAJ,CAAS;MAC1B2B,YAAY,EAAG,KAAKA,YADM;MAE1BuB,WAAW,EAAGA;IAFY,CAAT,CAAnB;IAKA,KAAK7B,WAAL,CAAiBsC,EAAjB,CAAoB,UAApB,EAAgC,KAAKxB,cAAL,CAAoByB,IAApB,CAAyB,IAAzB,CAAhC;IACA,KAAKvC,WAAL,CAAiBwC,IAAjB;EACD,CAXD,MAYK;IACH;IACA;IACA;IACAX,WAAW,CAACY,OAAZ,GAAsB,KAAKhD,YAA3B;IACA,IAAIiD,OAAO,GAAG,IAAI7D,cAAJ,CAAmBgD,WAAnB,CAAd;IAEA,KAAKnB,aAAL,CAAmBiC,WAAnB,CAA+BD,OAA/B,EAAwC,KAAKE,eAAL,CAAqBL,IAArB,CAA0B,IAA1B,CAAxC;EACD;;EAED,KAAKpC,0BAAL,GAAkC,KAAlC;AACD,CAlCD;AAoCA;AACA;AACA;AACA;AACA;AACA;;;AACAnB,QAAQ,CAAC6B,SAAT,CAAmB+B,eAAnB,GAAqC,UAASC,QAAT,EAAmB;EACtD;EACA;EACA,IAAI,KAAKxC,WAAT,EAAsB;IACpB;EACD,CALqD,CAOtD;EACA;;;EACA,IAAI,KAAKJ,YAAT,EAAuB;IACrB,KAAKA,YAAL,CAAkB6C,WAAlB,CAA8B,KAAK1C,YAAnC;EACD;;EAED,KAAKH,YAAL,GAAoB,IAAInB,KAAJ,CAAU;IAC5BI,GAAG,EAAE,KAAKA,GADkB;IAE5ByB,IAAI,EAAEkC,QAAQ,CAACE,UAFa;IAG5BC,WAAW,EAAE;EAHe,CAAV,CAApB;EAKA,KAAK5C,YAAL,GAAoB,KAAKU,cAAL,CAAoByB,IAApB,CAAyB,IAAzB,CAApB;EACA,KAAKtC,YAAL,CAAkBgD,SAAlB,CAA4B,KAAK7C,YAAjC;AACD,CApBD;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACApB,QAAQ,CAAC6B,SAAT,CAAmBoC,SAAnB,GAA+B,UAAS7B,OAAT,EAAkB8B,QAAlB,EAA4B;EACzD;EACA,IAAI9B,OAAO,CAAC,CAAD,CAAP,KAAe,GAAnB,EACA;IACEA,OAAO,GAAGA,OAAO,CAACE,SAAR,CAAkB,CAAlB,CAAV;EACD,CALwD,CAMzD;;;EACA,IAAI,CAAC,KAAKpB,UAAL,CAAgBkB,OAAhB,CAAL,EAA+B;IAC7B,KAAKlB,UAAL,CAAgBkB,OAAhB,IAA2B;MACzBM,GAAG,EAAE;IADoB,CAA3B;;IAGA,IAAI,CAAC,KAAKvB,0BAAV,EAAsC;MACpCgD,UAAU,CAAC,KAAKvB,UAAL,CAAgBW,IAAhB,CAAqB,IAArB,CAAD,EAA6B,KAAKhD,WAAlC,CAAV;MACA,KAAKY,0BAAL,GAAkC,IAAlC;IACD;EACF,CARD,CASA;EATA,KAUK,IAAI,KAAKD,UAAL,CAAgBkB,OAAhB,EAAyBD,SAA7B,EAAwC;IAC3C+B,QAAQ,CAAC,KAAKhD,UAAL,CAAgBkB,OAAhB,EAAyBD,SAA1B,CAAR;EACD;;EACD,KAAKjB,UAAL,CAAgBkB,OAAhB,EAAyBM,GAAzB,CAA6B0B,IAA7B,CAAkCF,QAAlC;AACD,CArBD;AAuBA;AACA;AACA;AACA;AACA;AACA;;;AACAlE,QAAQ,CAAC6B,SAAT,CAAmBiC,WAAnB,GAAiC,UAAS1B,OAAT,EAAkB8B,QAAlB,EAA4B;EAC3D;EACA,IAAI9B,OAAO,CAAC,CAAD,CAAP,KAAe,GAAnB,EACA;IACEA,OAAO,GAAGA,OAAO,CAACE,SAAR,CAAkB,CAAlB,CAAV;EACD;;EACD,IAAIC,IAAI,GAAG,KAAKrB,UAAL,CAAgBkB,OAAhB,CAAX;;EACA,KAAK,IAAIM,GAAG,GAAGH,IAAI,IAAIA,IAAI,CAACG,GAAb,IAAoB,EAA9B,EAAkC2B,GAAG,GAAG3B,GAAG,CAAC4B,MAAjD,EAAyDD,GAAG,EAA5D,GAAiE;IAC/D,IAAI3B,GAAG,CAAC2B,GAAD,CAAH,KAAaH,QAAjB,EAA2B;MACzBxB,GAAG,CAAC6B,MAAJ,CAAWF,GAAX,EAAgB,CAAhB;IACD;EACF;;EACD,IAAI,CAACH,QAAD,IAAaxB,GAAG,CAAC4B,MAAJ,KAAe,CAAhC,EAAmC;IACjC,OAAO,KAAKpD,UAAL,CAAgBkB,OAAhB,CAAP;EACD;AACF,CAfD;AAiBA;AACA;AACA;;;AACApC,QAAQ,CAAC6B,SAAT,CAAmB2C,OAAnB,GAA6B,YAAW;EACtC,KAAKnD,WAAL,GAAmB,IAAnB;EACA,KAAKC,YAAL,CAAkBkD,OAAlB;;EACA,IAAI,KAAKvD,YAAT,EAAuB;IACrB,KAAKA,YAAL,CAAkB6C,WAAlB,CAA8B,KAAK1C,YAAnC;EACD;AACF,CAND;;AAQAqD,MAAM,CAACC,OAAP,GAAiB1E,QAAjB"},"metadata":{},"sourceType":"script"}